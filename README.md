# UKNC_upgrades
Hardware extensions for UKNC (Soviet PDP-11 compatible machine)

Репозирорий создан как хранилище информации по аппаратным расширениям сделанным/разрабатываемых
для ПК [Электроника МС 0511(УКНЦ)](https://ru.wikipedia.org/wiki/%D0%AD%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%B8%D0%BA%D0%B0_%D0%9C%D0%A1_0511).

**mc0511_05.pdf** - схема самого ПК, взято с сайта [micklab.ru](http://micklab.ru/MC0511.htm)

## ay_and_dac_vm1
Реализация подключеня звукогенератора AY-3-8910 и двухканального ЦАП'а.

[Тема](http://zx-pk.ru/threads/29020-zvukovoj-kontroller-dlya-uknts.html) на форуме zx-pk.ru где обсуждалась данная реализация.
## sram_cpu_two_windows
[Модуль SRAM.](https://zx-pk.ru/threads/29492-alternativnyj-form-faktor-dlya-uknts-rasshirenie/)

После того, как я неожиданно заметил, что у ЦП свободно 7.5КБ адресного пространства (и это при 64КБ которые ЦП способен адресовать) было решено немедленно заполнить их дополнительной памятью. В результате возникла данная реализация.

На модуле установлен 1МБ памяти. Доступ к ним производится через два окна 0160000-0167777 и 0170000-0175777, т.е. первое окно 4КБ, второе 3КБ. Через каждое окно можно получить доступ ко всему объему памяти, но через верхнее окно можно получить доступ только к нижним 3КБ страницы.

Переключение страниц осуществляется записью в регистр по адресу 0176000, младший байт переключает страницу в первом, 4-х килобайтном окне, старший во втором.

По сигналу сброс, регистры страниц обнуляются, но т.к. регистр верхнего окна инверсный, получается что отсчёт страниц идёт с противоположных границ 1МБ-айтного диапазона. Т.е. после записи в один регистр 0, а в другой 255, в оба окна будет подставлена одна и таже страница.

Как выяснилось, несмотря на то что RT-11 может использовать дополнительную память (по умолчанию верхняя граница 0170000), драйвера, часть кода которых исполняется ПП не работают, из за того что ПП не имеет доступа к дополнительной памяти.

Для таких драйверов необходимо задать верхнюю границу для RT-11 0160000. Либо использую системную утилиту `SIPP`, предварительно найдя в файле `RTSJ.MAP` адрес на который указывает символ `..28KW` (подробно описано в RT-11 Installation Guide). Либо воспользоваться сторонней утилитой [`SYSTOP`](https://zx-pk.ru/threads/10718-soft-dlya-dvk-pdp11.html?p=932386&viewfull=1#post932386)

